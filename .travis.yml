before_install:
  - sudo apt-get update -qq
  # NOTE: fixes Travis CI [issue](https://github.com/travis-ci/travis-ci/issues/3106)
  - sudo rm -f /etc/apt/sources.list.d/travis_ci_zeromq3-source.list
  - sudo apt-get install -y cython python-h5py pkg-config python-lxml python-matplotlib python-mysqldb python-pandas python-scikits-learn python-scipy python-vigra python-wxgtk2.8 python-zmq
  # TODO: submit python-javabridge package to Ubuntu repository
  - pip install javabridge
  - pip install --upgrade git+https://github.com/h5py/h5py.git
  # TODO: submit cellh5 package to PyPI and python-cellh5 package to Ubuntu repository
  - git clone https://github.com/CellH5/cellh5.git
  - cd cellh5 && python setup.py install
  - cd .. && python CellProfiler.py --build-and-exit
cache:
  pip: true
language: python
notifications:
  email: false
python:
  - 2.7
script: python cpnose.py --noguitests --with-javabridge cellprofiler/tests/
virtualenv:
  system_site_packages: true
