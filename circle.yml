database:
  pre:
    - brew services start mysql
dependencies:
  cache_directories:
    - /usr/local/lib/python2.7/site-packages
  override:
    - pip install --editable .[test] --upgrade
  pre:
    - brew update
    - brew install mysql wxpython
    - pip install --upgrade cython numpy scipy
deployment:
  master:
    branch: features/circle
    commands:
      - pip install --upgrade pyinstaller
      - pyinstaller CellProfiler.spec
      - cp /usr/local/Cellar/libpng/1.6.31/lib/libpng16.16.dylib dist/CellProfiler.app/Contents/MacOS
      - rm dist/CellProfiler.app/Contents/MacOS/libwx*3.0.dylib
general:
  artifacts:
    - dist/CellProfiler.app
machine:
  xcode:
    version: 8.3
test:
  override:
    - echo "foo"
